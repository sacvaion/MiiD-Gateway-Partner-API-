# MiiD Gateway Partner Api

![N|Solid](https://miid.bio/wp-content/uploads/2021/06/MiID_ico-100x100.png)

**MiiD Gateway** is an API that provides the functionality to connect your platform or system to MiiD Gateway Service 

## Operations

 - [Authorization - Login](#ApiGatewayAutorization)
 - [Get User By Document](#ApiGatewayGetUserByDocument)
 - [Get Authentication Mechanism](#ApiGatewayGetAuthenticationMechanism)
 - [Get Result By Process Id](#ApiGatewayGetResultByProcessId)
 - [Get Result By External Id Process](#ApiGatewayGetResultByExternalIdProcess)
 - [Get Images Result By Process Id](#ApiGatewayGetImagesResultByProcessId)
 - [Get Images Result By External Id Process](#ApiGatewayGetImagesResultByExternalIdProcess)
 - [Upload Files to process in Background](#ApiGatewayUploadFile) (Upload documents and finger images)
 - [DetectAndCheckLiveness](#ApiGatewayDetectAndCheckLiveness) (Upload face images only)
 - [Enroll Person Gateway Sync](#ApiGatewayEnrollPersonGateway)
 - [Enroll Person Gateway Async](#ApiGatewayEnrollPersonAsync)
 - [Validate Doc Person Async Gateway](#ValidateDocPersonAsyncGateway)
 - [Authentication Person Face](#ApiGatewayAuthenticationPersonFace)
 - [Authentication Person Finger](#ApiGatewayAuthenticationPersonFinger)

**MiiD Gateway**  is a commercial Service, to use it contact [info@bytte.com.co](mailto:info@bytte.com.co) for instructions on how to obtain the required resources and access

**MiiD** is a trademark registered by Bytte S.A.S 
 
## Operations:
## <a name="ApiGatewayAutorization"></a>Api Gateway Autorization
To use the API, you must have a valid user assigned by MiiD team!!

Url - Login User - POST
https://servicesdev.miid.bio/Login/LoginUser/

```json
{
    "emailAddress": "MyUseraccess@mymail.bio",
    "password": "MyPassword"
}
```
If user/Password are valid, Api returns similar JSON Response

```json
{
    "tokenType": "Bearer",
    "accessToken": "eyJ0eXAiiJKV1QiLCJhbGc....",
    "successOperation": true
}
```

Use Access Token to call the other services provided by this api

---
## <a name="ApiGatewayGetUserByDocument"></a> Get User Data By Document
This operation returns the demographic and biometric information of the person

Variables to Send:
* **EnterpriseClientId** = Is a Identifier provided by MiiD Team. This Identifier is unique by client
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number  

Response fields: 
* **fingers** = Array of enrolled fingers
* **documentType** = Document Type of person
* **documentNumber** = Document Number of person
* **firstName** = First name
* **lastName** = Last Name
* **isEnrollFace** = If Person have enrollment with Face biometric factor
* **isEnrollFingers** = If Person have enrollment with Fingers biometric factor
* **isEnrollVoice** = If Person have enrollment with Voice biometric factor

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetUserByDocument/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "documentType": "1",
    "documentNumber": "80208223",    
    "enterpriseClientId": 4500
}
```
Response:
```json
{
    "biometricPerson": {
        "fingers": [
            {
                "fingerId": 2,                
            }
        ],                 
        "documentType": "1",
        "documentNumber": "80208223",
        "firstName": "ALLAN YEISSON",
        "lastName": "DIAZ BALLESTEROS",
        "isEnrollFace": true,
        "isEnrollVoice": false,
        "isEnrollFingers": true
    }
} 
```
---
## <a name="ApiGatewayGetAuthenticationMechanism"></a> Get Authentication Mechanism
> **Use only if the user is enrolled with finger or face biometric factor**

This operation returns the suggested authentication mechanisms for the user.

Variables to Send:
* **EnterpriseClientId** = Is a Identifier provided by MiiD Team. This Identifier is unique by client
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number  

Response fields: 
* **BiometricFactor** = List of suggested Biometric factors
* **id** = Identifier of Biometric factor
* **name** = Name of Biometric factor

> **Biometric Factor Values**:
* **1** = Finger
* **2** = Face
* **3** = Voice

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetAuthenticationMechanism/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "documentType": "1",
    "documentNumber": "80208223",    
    "enterpriseClientId": 4500
}
```
Response:
```json
[
    {
        "id": 2,
        "name": "FACE"
    }
] 
```
---
## <a name="ApiGatewayGetResultByProcessId"></a>Get Result By Process Id
This operation returns detailed information from a Authentication process

Use Only if Process id was generated by operation **EnrollPersonAsyncGateway**

Variables to Send:
* **processId** = Is a unique identifier generated by operation *EnrollPersonAsyncGateway*

Response fields:
* **enterpriseClientId** = Is a Identifier provided by MiiD Team. This Identifier is unique by client 
* **id** = MiiD Internal Identifier
* **creationDate** = Creation Date
* **finishDate** = Finish Date
* **personId** = MiiD internal Person Identifier
* **type** = Process Type
* **origin** = Origin Type
* **barcodeMrz** = Barcode/MRZ Base64 From document
* **externalId** = Is a current client Identifier (in the client information system)
* **scoreFingerBarcode** = Score Match fingerprint captured Vs document fingerprint
* **scoreFace** = Score Match Face captured Vs face in document
* **scoreLiveness** = Score Face Liveness
* **scoreOcrBarcode** = Score Match Ocr Vs BarCode
* **scoreAniBarcode** = Score Match Ani Vs BarCode
* **scoreAniOcr** = Score Match Ani Vs Ocr
* **scoreWeigthDocument** = Score Weighted weight greater than configured  
* **scoreBykeeper** = Result ByKeeper Validation (0 - false, 1 true)
* **scoreList** = Score restrictive lists
* **scoreProcess** = General Score

* **Status Values** 
* *0* = Process not executed 
* *1* = Process execute and finish correctly
* *2* = The process runs and does not finish correctly

* **statusFingerBarcode** = Status Match fingerprint captured Vs document fingerprint (0,1,2)
* **statusFace** = Status Match Face captured Vs face in document (0,1,2)
* **statusLiveness** = Status Face Liveness (0,1,2)
* **statusOcrBarcode** = Status Match Ocr Vs BarCode (0,1,2)
* **statusAniBarcode** = Status Match Ani Vs BarCode (0,1,2)
* **statusAniOcr** = Status Match Ani Vs Ocr (0,1,2)
* **statusWeigthDocument** = Status Weighted weight greater than configured (0,1,2)
* **statusBykeeper** = Status ByKeeper (0,1,2)
* **statusList** =  Status restrictive lists
* **statusProcess** = General Process Status (True = User Authenticated)
* **inProcess** =If True, the process has not finished and you must wait for this flag to change to false 

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetResultByExternalIdProcess/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "externalId": "external unique process id"    
}
```

Response:
```json
{
    "id": "4b011b09-629c-4e4e-a115-480afb73fc41",
    "enterpriseClientId": 42000,
    "personId": "2d5b36c1-aedd-4607-be19-cffa5470e1e6",
    "creationDate": "2023-02-21T12:00:59.4681117-05:00",
    "finishDate": "2023-02-21T12:01:50.1163693-05:00",
    "externalId": "11223344-111123-2047aa",
    "tokenId": "91025",
    "type": "EnrollGatewayHologramas",
    "origin": "ALIADO STANDARD",
    "barcodeMrz": "MDM1NzI5ODEz...",    
    "syncBykeeper": true,
    "statusProcess": true, --> Variable to evaluate
    "statusReturn": "SSUCCESS",
    "inProcess": false,
    "mailProcess": "allan.diaz@bytte.com.co",
    "enrollFinger": 1,
    "enrollFace": 1
} 
```
-------
## <a name="ApiGatewayGetResultByExternalIdProcess"></a>Get Result By External IdProcess
This operation returns detailed information from a Authentication process

Variables to Send:

* **TokenBearer** = Is a Token Value previously generated
* **ExternalId** = Is a External Identificator (client transaction identificator)

Response fields:
 **Same response of operation Get Result By Process Id**

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetResultByProcessId/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "externalId": "external unique process id"    
}
```

Response:
```json
{
    "id": "4b011b09-629c-4e4e-a115-480afb73fc41",
    "enterpriseClientId": 42000,
    "personId": "2d5b36c1-aedd-4607-be19-cffa5470e1e6",
    "creationDate": "2023-02-21T12:00:59.4681117-05:00",
    "finishDate": "2023-02-21T12:01:50.1163693-05:00",
    "externalId": "11223344-111123-2047aa",
    "tokenId": "91025",
    "type": "EnrollGatewayHologramas",
    "origin": "ALIADO STANDARD",
    "barcodeMrz": "MDM1NzI5ODEz...",    
    "syncBykeeper": true,
    "statusProcess": true, --> Variable to evaluate
    "statusReturn": "SSUCCESS",
    "inProcess": false,
    "mailProcess": "allan.diaz@bytte.com.co",
    "enrollFinger": 1,
    "enrollFace": 1
}
 
```
-------
## <a name="ApiGatewayGetImagesResultByProcessId"></a>Get Result By Process Id
This operation returns detailed information from a Authentication process

Use Only if Process id was generated by operation **EnrollPersonAsyncGateway**

Variables to Send:
* **processId** = Is a unique identifier generated by operation *EnrollPersonAsyncGateway*

Response fields:
* **Log Document Array Object**
  * for each item:
  * **id** = Is a internal Identifier 
  * **type** = Enum Value  (int)
    * 1 - Front Document
    * 2 - Back Document 
  * **documentBase64** = Image in base64 encoding

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetImagesResultByProcessId/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "processId" : "1055e2c5-19a3-40b5-b02c-dd81b95a8766"
}
```

Response:
```json
[
    {
        "id": "35f253ac-3c35-40ed-ab89-349ddbd16401",
        "type": 1,
        "documentBase64": "/9j/4AAQSkZJRgABAQAAS...."
    },
    {
        "id": "a9d5cb57-8dc3-462a-a2d1-1a80d6fb8097",
        "type": 2,
        "documentBase64": "/9j/4AAQSkZJRgABAQAAS...."
    }
]
```
-------
## <a name="ApiGatewayGetImagesResultByExternalIdProcess"></a>Get Image Result By External IdProcess
This operation returns (if exists) documents images used in a Authentication process

Variables to Send:

* **TokenBearer** = Is a Token Value previously generated
* **ExternalId** = Is a External Identificator (client transaction identificator)

Response fields:
* **Log Document Array Object**
  * for each item:
  * **id** = Is a internal Identifier 
  * **type** = Enum Value  (int)
    * 1 - Front Document
    * 2 - Back Document 
  * **documentBase64** = Image in base64 encoding

Url - GetImagesResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetImagesResultByExternalIdProcess/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body:
```json
{
    "externalId": "external unique process id"    
}
```

Response:
```json
[
    {
        "id": "35f253ac-3c35-40ed-ab89-349ddbd16401",
        "type": 1,
        "documentBase64": "/9j/4AAQSkZJRgABAQAAS...."
    },
    {
        "id": "a9d5cb57-8dc3-462a-a2d1-1a80d6fb8097",
        "type": 2,
        "documentBase64": "/9j/4AAQSkZJRgABAQAAS...."
    }
]
```
---
## <a name="ApiGatewayEnrollPersonGateway"></a>Enroll Person Gateway Sync
*This operation is synchronic*

This operation process biometric information in backend server

Variables to Send:

Url - POST
> https://servicesdev.miid.bio/Partner/EnrollPersonGateway/

Body Type
* **Form/Data**

Form Variables

* **Face** : Binary file with a face selfie capture
* **FingerX** : Binary file with a fingerprint data capture
  X value can be from 1 to 10 or 20-21
  
  A record is generated for each fingerprint 
  
* **BarcodeBase64**: Barcode PDF417/MRZ encoded string
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **DocumentBackImage** :  Binary file with a back document capture
* **DocumentFrontImage** :  Binary file with a front document capture
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number

Response example:
```json
{
    "id": "4b011b09-629c-4e4e-a115-480afb73fc41",
    "enterpriseClientId": 42000,
    "personId": "2d5b36c1-aedd-4607-be19-cffa5470e1e6",
    "creationDate": "2023-02-21T12:00:59.4681117-05:00",
    "finishDate": "2023-02-21T12:01:50.1163693-05:00",
    "externalId": "11223344-111123-2047aa",
    "tokenId": "91025",
    "type": "EnrollGatewayHologramas",
    "origin": "ALIADO STANDARD",
    "barcodeMrz": "MDM1NzI5ODEz...",    
    "syncBykeeper": true,
    "statusProcess": true, --> field to evaluate!
    "statusReturn": "SSUCCESS",
    "inProcess": false,
    "mailProcess": "allan.diaz@bytte.com.co",
    "enrollFinger": 1,
    "enrollFace": 1
}
```

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/EnrollPersonGateway' \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'Face=@"//imgSelfie.jpg"' \     --> You can also use DataKey from detect and Check Liveness response upload file!
--form 'Finger3=@"//insHuella2.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger4=@"//insHuella3.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger5=@"//insHuella4.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger2=@"//insHuella1.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger21=@"//insHuella21.jpg"' \ -->You can also use DataKey from response upload file!
--form 'BarcodeBase64="MDIwMTYyOT..."' \
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage=@"//reversoCO.jpg"' \
--form 'DocumentFrontImage=@"//frenteCO.png"' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---
**Response Information**:


Response – Status 200: User authenticated and enrolled
```json
{
    "id": "a12f8bb1-3518-46b3-8b14-01c3d71b392d",
     … (other values)
    "statusProcess": true,
    "statusReturn": "SUCCESS"
}
```

Response – Status 200: User with error and enrolled
```json
{
    "id": "a12f8bb1-3518-46b3-8b14-01c3d71b392d",
     … (other values)
    "statusProcess": false,
    "statusReturn": "NO_ENROLL"
}
```

Response – Status 200: User – this will be answer other questions (another functional flow named Listas restrictivas)
```json
{
    "id": "a12f8bb1-3518-46b3-8b14-01c3d71b392d",
     … (other values)
    "statusProcess": false,
    "statusReturn": "LISTAS"
}
``` 

Response – Status 401:
```json
{
  "Message": "Authorization has been denied for this request."
}
```
---
## <a name="ApiGatewayEnrollPersonAsync"></a>Enroll Person Gateway Async
*This operation is Asynchronic*

*Best Performance!*

This operation process biometric information in backend server

This operation return a unique process Id. this id can be used to get the status of process with operation **GetResultByProcessId**

Url - POST
> https://servicesdev.miid.bio/Partner/EnrollPersonAsyncGateway/

Variables to Send:

Body Type
* **Form/Data**

Form Variables

* **Face** : Binary file with a face selfie capture
* **FingerX** : Binary file with a fingerprint data capture
  X value can be from 1 to 10 or 20-21
  
  A record is generated for each fingerprint 
  
* **BarcodeBase64**: Barcode PDF417/MRZ encoded string
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **DocumentBackImage** :  Binary file with a back document capture
* **DocumentFrontImage** :  Binary file with a front document capture
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number

Response example:
```json
{
    "processId": "9e9de99c-948c-4b40-9b6d-5f1dbb693af8",
    "tokenValid": true,
    "statusProcess": true
}
```

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/EnrollPersonAsyncGateway' \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'Face=@"//imgSelfie.jpg"' \   --> You can also use DataKey from detect and Check Liveness response upload file!
--form 'Finger3=@"//insHuella2.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger4=@"//insHuella3.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger5=@"//insHuella4.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger2=@"//insHuella1.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger21=@"//insHuella21.jpg"' \ --> You can also use DataKey from response upload file!
--form 'BarcodeBase64="MDIwMTYyOT..."' \
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage=@"//reversoCO.jpg"' \
--form 'DocumentFrontImage=@"//frenteCO.png"' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---
**Response Information**:


Response – Status 200: User authenticated and enrolled
```json
{
    "processId": "9e9de99c-948c-4b40-9b6d-5f1dbb693af8",
    "tokenValid": true,
    "statusProcess": true
}
```

Response – Status 401:
```json
{
  "Message": "Authorization has been denied for this request."
}
```
----


## <a name="ValidateDocPersonAsyncGateway"></a>Validate Doc Person Async Gateway
*This operation is Asynchronic*

*Best Performance!*

This operation process biometric information in backend server

This operation return a unique process Id. this id can be used to get the status of process with operation **GetResultByProcessId**

Url - POST
> https://servicesdev.miid.bio/Partner/ValidateDocPersonAsyncGateway/

Variables to Send:

Body Type
* **Form/Data**

Form Variables


* **BarcodeBase64**: Barcode PDF417/MRZ encoded string
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **DocumentBackImage** :  Binary file with a back document capture
* **DocumentFrontImage** :  Binary file with a front document capture
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number


Or if you are using PKI

* **BarcodeBase64**: Barcode PDF417/MRZ encoded string
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **documentbackpki** :  PKI Text
* **documentfrontpki** :  PKI Text
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number


Response example:
```json
{
    "processId": "9e9de99c-948c-4b40-9b6d-5f1dbb693af8",
    "tokenValid": true,
    "statusProcess": true
}
```

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/ValidateDocPersonAsyncGateway \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'BarcodeBase64="MDIwMTYyOT..."' \
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage=@"//reversoCO.jpg"' \
--form 'DocumentFrontImage=@"//frenteCO.png"' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---

Call PKI Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/ValidateDocPersonAsyncGateway \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'BarcodeBase64="MDIwMTYyOT..."' \
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'documentbackpki="PKI__PKwDEPaEVYojAryISeDJPH1MiVT85xF ..."' \
--form 'documentfrontpki="PKI__orXQ+e3XDuGyCw9pk61vmABrD9ioxq ..."' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---

**Response Information**:


Response – Status 200: User authenticated and enrolled
```json
{
    "processId": "9e9de99c-948c-4b40-9b6d-5f1dbb693af8",
    "tokenValid": true,
    "statusProcess": true
}
```

Response – Status 401:
```json
{
  "Message": "Authorization has been denied for this request."
}
```
----




## <a name="ApiGatewayAuthenticationPersonFace"></a>Authentication Person Face
> **Use only if the user is enrolled with FACE biometric factor**

This operation authenticate a person previously enrolled with Face Biometric factor

Url - POST
> https://servicesdev.miid.bio/Partner/AuthenticationPersonFace/

Variables to Send:

Body Type
* **Form/Data**

Form Variables

* **Face** : Binary file with a face selfie capture    
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number
* **DocumentBackImage** *(optional)* :  Binary file with a back document capture
* **DocumentFrontImage** *(optional)*:  Binary file with a front document capture
* **BarcodeBase64** *(optional)*: Barcode PDF417/MRZ encoded string

Response example:
```json
{
    "id": "c219af63-f28b-4d5d-9377-5be7670a4db9",
    "factor": "Face",
    "enterpriseClientId": 0,
    "personId": "e96ea8ac-6898-4f8d-820d-ec421aa19fc0",
    "creationDate": "2023-02-22T16:33:53.6359286-05:00",
    "finishDate": "2023-02-22T16:34:05.3746935-05:00",
    "externalId": "XXXaaaa1112233",
    "type": "AtPersonFace",
    "origin": "APP",
    "tokenId": "13162",
    "barcodeMrz": "MDM1ODAwNzU...",
    "statusProcess": true, -->Variable to evaluate
    "statusReturn": "AUTHENTICATION SUCCESS",
}
```

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/AuthenticationPersonFace' \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'Face=@"//imgSelfie.jpg"' \    --> You can also use DataKey from detect and Check Liveness response upload file!
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage=@"//reversoCO.jpg"' \ (optional) --> You can also use DataKey from response upload file!
--form 'DocumentFrontImage=@"//frenteCO.png"' \ (optional) --> You can also use DataKey from response upload file!
--form 'BarcodeBase64="MDIwMTYyOT..."' \ (optional)
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---
**Response Information**:
 
Response – Status 401:
```json
{
  "Message": "Authorization has been denied for this request."
}
```
---
## <a name="ApiGatewayAuthenticationPersonFinger"></a>Authentication Person Finger
> **Use only if the user is enrolled with FINGERS biometric factor**

This operation authenticate a person previously enrolled with Finger Biometric factor

Url - POST
> https://servicesdev.miid.bio/Partner/AuthenticationPersonFinger/

Variables to Send:

Body Type
* **Form/Data**

Form Variables

* **FingerX** : Binary file with a fingerprint data capture
  X value can be from 1 to 10 or 20-21
  
  A record is generated for each fingerprint 
  
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number
* **DocumentBackImage** *(optional)* :  Binary file with a back document capture
* **DocumentFrontImage** *(optional)* :  Binary file with a front document capture
* **BarcodeBase64** *(optional)*: Barcode PDF417/MRZ encoded string


Response example:
```json
{
    "id": "41f2bee3-5e7a-4ee7-ae3a-c4c91aea14c5",
    "factor": "Finger",
    "enterpriseClientId": 0,
    "personId": "e96ea8ac-6898-4f8d-820d-ec421aa19fc0",
    "creationDate": "2023-02-22T16:22:08.6694471-05:00",
    "finishDate": "2023-02-22T16:23:04.9098628-05:00",
    "externalId": "XXXaaaa1112233",
    "type": "AtPersonFinger",
    "origin": "APP",
    "tokenId": "28202",
    "barcodeMrz": "MDM1ODAwNz...",
    "statusProcess": true, --> Variable to evaluate
    "statusReturn": "AUTHENTICATION MATCH"    
}
```

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/AuthenticationPersonFinger' \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'Finger3=@"//insHuella2.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger4=@"//insHuella3.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger5=@"//insHuella4.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger2=@"//insHuella1.jpg"' \ --> You can also use DataKey from response upload file!
--form 'Finger21=@"//insHuella21.jpg"' \ --> You can also use DataKey from response upload file!
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223 \
--form 'DocumentBackImage=@"//reversoCO.jpg"' \ (optional) --> You can also use DataKey from response upload file!
--form 'DocumentFrontImage=@"//frenteCO.png"' \ (optional) --> You can also use DataKey from response upload file!
--form 'BarcodeBase64="MDIwMTYyOT..."' \        (optional)
```
---
**Response Information**: 

Response – Status 401:
```json
{
  "Message": "Authorization has been denied for this request."
}
```
----
## <a name="ApiGatewayUploadFile"></a>Upload file to process in Enrollment or Authentication
This operation allows uploading a file, obtaining an unique identifier and later using it instead of sending the file in the enrollment and authentication operations.

> The purpose of this operation is to allow files to be loaded in the background, and at the end of the flow to send only string values and not binary files.

Url - POST
> https://servicesdev.miid.bio/Partner/UploadImage/

Variables to Send:

Body Type
* **Form/Data**

Form Variables

* **key** :  Binary file to upload
* **sessionid** :  Session Id (Sdk Generate this value)

Call Example
```console
curl --location 'https://servicesdev.miid.bio/Person/UploadImage' \
--header 'Authorization: Bearer eyJ0eXA...' \
--form 'key=@"/Allan/FP_HuellaPW123.bytte"' \
--form 'sessionid="bytte123"'
```

Response example:
```json
{
    "dataKey": "2d401ca2-5b3a-4a41-82d8-101afd7c1095",
    "successOperation": true
}
```

**Instead of sending the binary file, the datakey Identifier (string) must be sent**

> DataKey values can be used in this operations:

* EnrollPersonSync **(Documents images, and fingers images)**
* EnrollPersonAsync **(Documents images, and fingers images)**
* AuthenticationPersonFace **(Documents images only)**
* AuthenticationPersonFinger **(Documents images, and fingers images)**

> To Upload Face Image, use **DetectAndCheckLiveness** Operation

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/AuthenticationPersonFace' \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'Face="2d401ca2-5b3a-4a41-82d8-101afd7c1095"' \ --> DataKey from detect and Check Liveness response upload file!
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage="05ed66f7-0c16-4df3-821a-3332af68447d"' \ (optional) --> DataKey from response upload file!
--form 'DocumentFrontImage="44bc4c13-0ead-4346-a752-57d7a6b3931c"' \ (optional) --> DataKey from response upload file!
--form 'BarcodeBase64="MDIwMTYyOT..."' \ (optional)
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

----
## <a name="ApiGatewayDetectAndCheckLiveness"></a>Detect And Check Liveness 
This operation allows uploading only a Face File, obtaining an unique identifier and later using it instead of sending the file in the enrollment and authentication operations.

> The purpose of this operation is validate the face file

Url - POST
> https://servicesdev.miid.bio/CheckLiveness/DetectAndCheckLiveness/

Variables to Send:

Body Type
* **Form/Data**

Form Variables

* **face** :  Binary file to upload
* **sessionid** :  Session Id (Sdk Generate this value)
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number

Call Example
```console
curl --location 'https://servicesdev.miid.bio/CheckLiveness/DetectAndCheckLiveness/' \
--header 'Authorization: Bearer eyJ0eXA...' \
--form 'face=@"/Allan/FP_HuellaPW123.bytte"' \
--form 'sessionid="bytte123"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223"' \
```

Response example:
```json
{  
    "valid": true, --> Variable to evaluate (if true, face is valid, otherwise the process must capture the face again)
    "dataKey": "b23877b4-aa4e-44a0-832b-a08fe39afc0b"
}
```

**Instead of sending the binary file, the datakey Identifier (string) must be sent**

> DataKey values can be used in this operations:

* EnrollPersonSync (face datakey)
* EnrollPersonAsync (face datakey)
* AuthenticationPersonFace (face datakey)

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/AuthenticationPersonFace' \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'Face="b23877b4-aa4e-44a0-832b-a08fe39afc0b"' \ --> DataKey from detect and Check Liveness response upload file!
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage="05ed66f7-0c16-4df3-821a-3332af68447d"' \ (optional)  --> DataKey from response upload file!
--form 'DocumentFrontImage="44bc4c13-0ead-4346-a752-57d7a6b3931c"' \ (optional) --> DataKey from response upload file!
--form 'BarcodeBase64="MDIwMTYyOT..."' \ (optional)
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```